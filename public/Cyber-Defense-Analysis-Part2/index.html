<!DOCTYPE html>
<html lang="en">

<head><script src="/blog/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=blog/livereload" data-no-instant defer></script>
  <title>
  Cyber Defense Analysis Part2 · DarkAwesome
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="DarkAwesome">
<meta name="description" content="This is a continuation of the previous work done by Dimitri Nilov (https://www.gotechinsights.com/blog/part2cybertrends).">
<meta name="keywords" content="">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Cyber Defense Analysis Part2">
  <meta name="twitter:description" content="This is a continuation of the previous work done by Dimitri Nilov (https://www.gotechinsights.com/blog/part2cybertrends).">

<meta property="og:url" content="http://localhost:1313/blog/Cyber-Defense-Analysis-Part2/">
  <meta property="og:site_name" content="DarkAwesome">
  <meta property="og:title" content="Cyber Defense Analysis Part2">
  <meta property="og:description" content="This is a continuation of the previous work done by Dimitri Nilov (https://www.gotechinsights.com/blog/part2cybertrends).">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2024-11-19T21:55:25-05:00">
    <meta property="article:modified_time" content="2024-11-19T21:55:25-05:00">
    <meta property="article:tag" content="Ubuntu">




<link rel="canonical" href="http://localhost:1313/blog/Cyber-Defense-Analysis-Part2/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/blog/css/coder.css" media="screen">






  
    
    
    <link rel="stylesheet" href="/blog/css/coder-dark.css" media="screen">
  



 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="http://localhost:1313/blog/">
      DarkAwesome
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/blog/contact/">Contact</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/blog/blog/resume">Resume</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/blog/blog/">Posts</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container page">
  <article>
    <header>
      <h1 class="title">
        <a class="title-link" href="http://localhost:1313/blog/Cyber-Defense-Analysis-Part2/">
          Cyber Defense Analysis Part2
        </a>
      </h1>
    </header>

    <p>This is a continuation of the previous work done by Dimitri Nilov (<a href="https://www.gotechinsights.com/blog/part2cybertrends%29"  class="external-link" target="_blank" rel="noopener">https://www.gotechinsights.com/blog/part2cybertrends)</a>.</p>
<p>In this portion of the Cyber Defense Database research I have done a time series Analysis of the data from 2014 - 2022.</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Data manipulation libraries</span>
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">library</span>(sp)
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">library</span>(sf)
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">library</span>(spatstat)
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">library</span>(dplyr)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Plotting</span>
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">library</span>(leaflet)
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">library</span>(ggplot2)
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">library</span>(tmap)
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">library</span>(sf)
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">library</span>(terra)
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">library</span>(spData)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">library</span>(gganimate)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">library</span>(readxl)
</span></span><span style="display:flex;"><span>data <span style="color:#ff7b72;font-weight:bold">&lt;-</span> <span style="color:#d2a8ff;font-weight:bold">read_excel</span>(<span style="color:#a5d6ff">&#34;E:/RStudio/Rcode/umspp-export-2024-08-26(1).xlsx&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df <span style="color:#ff7b72;font-weight:bold">&lt;-</span> <span style="color:#d2a8ff;font-weight:bold">subset</span>(data, select<span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#d2a8ff;font-weight:bold">c</span>(slug,description,source_url,industry_code))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">summary</span>(df)
</span></span></code></pre></div><p><img src="blog/content/img/Cyber-Analysis/summary.png" alt="Summary"></p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>table1 <span style="color:#ff7b72;font-weight:bold">&lt;-</span> <span style="color:#d2a8ff;font-weight:bold">table</span>(df<span style="color:#ff7b72;font-weight:bold">$</span>motive, df<span style="color:#ff7b72;font-weight:bold">$</span>actor_type, 
</span></span><span style="display:flex;"><span>                df<span style="color:#ff7b72;font-weight:bold">$</span>event_type)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">ftable</span>(table1)
</span></span></code></pre></div><p><img src="blog/content/img/Cyber-Analysis/table1.png" alt="table1"></p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># FREQUENCY MARGINALS</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># row marginals - totals for each marital status across gender</span>
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">margin.table</span>(table1, <span style="color:#a5d6ff">2</span>)
</span></span></code></pre></div><p><img src="blog/content/img/Cyber-Analysis/table2.png" alt="table2"></p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># colum marginals - totals for each gender across marital status</span>
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">margin.table</span>(table1, <span style="color:#a5d6ff">1</span>)
</span></span></code></pre></div><p><img src="blog/content/img/Cyber-Analysis/MarginTable1.png" alt="MarginTable1"></p>
<h2 id="3-way-table">
  3 Way Table
  <a class="heading-link" href="#3-way-table">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Looking at the table of the motives, actor type and event type we can see that a lot of the attacks have a financial motive. With it being the combination with the greatest distribution further analyisis could reveal more on why. Or perhaps show when this became an issue or if it always was an issue. Protest-hacktivist and Undetermined-Criminal would be the other groups that have a good amount of a distribution among the attacks. Although it doesn’t have the same levels of distribution these are also areas that can show more information.</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">ggplot</span>(df, <span style="color:#d2a8ff;font-weight:bold">aes</span>(x <span style="color:#ff7b72;font-weight:bold">=</span> (event_type))) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>        <span style="color:#d2a8ff;font-weight:bold">geom_bar</span>(<span style="color:#d2a8ff;font-weight:bold">aes</span>(y <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">after_stat</span>(count)<span style="color:#ff7b72;font-weight:bold">/</span><span style="color:#d2a8ff;font-weight:bold">sum</span>(<span style="color:#d2a8ff;font-weight:bold">after_stat</span>(count)))) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>        <span style="color:#d2a8ff;font-weight:bold">xlab</span>(<span style="color:#a5d6ff">&#34;Event Types&#34;</span>) <span style="color:#ff7b72;font-weight:bold">+</span> <span style="color:#d2a8ff;font-weight:bold">ylab</span>(<span style="color:#a5d6ff">&#34;Count&#34;</span>) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>        <span style="color:#d2a8ff;font-weight:bold">facet_grid</span>(<span style="color:#ff7b72;font-weight:bold">~</span>actor_type) <span style="color:#ff7b72;font-weight:bold">+</span> <span style="color:#d2a8ff;font-weight:bold">geom_bar</span>(fill<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#39;coral2&#39;</span>) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>        <span style="color:#d2a8ff;font-weight:bold">theme</span>(axis.text.x <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">element_text</span>(angle <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">45</span>, hjust <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">1</span>))
</span></span></code></pre></div><p><img src="blog/content/img/Cyber-Analysis/EventTypeHist.png" alt="Event Types Histogram"></p>
<h2 id="event-type-histogram">
  Event Type histogram
  <a class="heading-link" href="#event-type-histogram">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>This histogram omits the motives and just shows the event types and actor types. At first glance we can see that the majority of attacks are criminal in nature. Looking at the histogram similar findings can be seen here. Although, now we can see that attacks that attributed to nation-states also have occurred quite a bit. (stopped here)</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">ggplot</span>(df, <span style="color:#d2a8ff;font-weight:bold">aes</span>(x<span style="color:#ff7b72;font-weight:bold">=</span>month)) <span style="color:#ff7b72;font-weight:bold">+</span> <span style="color:#d2a8ff;font-weight:bold">geom_bar</span>(fill<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#39;seagreen&#39;</span>) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">labs</span>(x<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#39;Months&#39;</span>) 
</span></span></code></pre></div><p><img src="blog/content/img/Cyber-Analysis/worldmapbymotive.png" alt="Event Types Histogram"></p>
<h2 id="attacks-per-month">
  Attacks per Month
  <a class="heading-link" href="#attacks-per-month">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Looking at this histogram we can see no seasonality among the data. Nor can we see any times in which the attacks spike relative to the normal distribution of data. January, March and August being the peaks do show some times where the events may be taking place more often across the years. However,looking at the surrounding months some fallacies could be apparent here. Mainly being the edge effects from when an event was coded to have occured. This has pushed me to look more at the years rather than the months of when these attacks occur.</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># install.packages(&#34;rnaturalearth&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">library</span>(rnaturalearth)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># rnaturalearth package to get geometries (spatial data) for countries. This package provides access to Natural Earth datasets, which include country geometries (polygons).</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Get country geometries using rnaturalearth</span>
</span></span><span style="display:flex;"><span>countries_geom <span style="color:#ff7b72;font-weight:bold">&lt;-</span> <span style="color:#d2a8ff;font-weight:bold">ne_countries</span>(scale <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;small&#34;</span>, returnclass <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;sf&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Merge the geometries with the country names</span>
</span></span><span style="display:flex;"><span>countries_sf <span style="color:#ff7b72;font-weight:bold">&lt;-</span> countries_geom <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">filter</span>(name <span style="color:#ff7b72;font-weight:bold">%in%</span> df<span style="color:#ff7b72;font-weight:bold">$</span>country) <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>         <span style="color:#8b949e;font-style:italic"># Filter for countries in your dataframe</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">left_join</span>(df, by <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">c</span>(<span style="color:#a5d6ff">&#34;name&#34;</span> <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;country&#34;</span>)) <span style="color:#8b949e;font-style:italic"># Join with your dataframe</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Set the CRS (WGS84 is EPSG:4326, which is common for world maps)</span>
</span></span><span style="display:flex;"><span>countries_sf <span style="color:#ff7b72;font-weight:bold">&lt;-</span> <span style="color:#d2a8ff;font-weight:bold">st_set_crs</span>(countries_sf, <span style="color:#a5d6ff">4326</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># getting rid of bloat in the sf dataframe</span>
</span></span><span style="display:flex;"><span>world_sf <span style="color:#ff7b72;font-weight:bold">&lt;-</span> countries_sf <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">select</span>(event_date, year, month, actor, actor_type, organization, industry_code, 
</span></span><span style="display:flex;"><span>         industry, motive, event_type, event_subtype, actor_country,geometry)
</span></span></code></pre></div><p>A problem was caught here with a value being coded incorrectly in the excel sheet. The single data point was dealing with Telecommunications companies in Sundan.</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>invalid_geometries <span style="color:#ff7b72;font-weight:bold">&lt;-</span> world_sf[<span style="color:#ff7b72;font-weight:bold">!</span><span style="color:#d2a8ff;font-weight:bold">st_is_valid</span>(world_sf), ]
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">print</span>(invalid_geometries, n <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">Inf</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">## getting rid of invalid polygon (might come back and figure out why this is wrong)</span>
</span></span><span style="display:flex;"><span>world_sf_valid <span style="color:#ff7b72;font-weight:bold">&lt;-</span> world_sf<span style="color:#d2a8ff;font-weight:bold">[st_is_valid</span>(world_sf), ]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">## this takes a minute to load </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">tm_shape</span>(world_sf_valid) <span style="color:#ff7b72;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">tm_borders</span>() <span style="color:#ff7b72;font-weight:bold">+</span>  <span style="color:#8b949e;font-style:italic"># Draw borders</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">tm_fill</span>(col <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;motive&#34;</span>, palette <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;Set3&#34;</span>, title <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;Motive&#34;</span>) <span style="color:#ff7b72;font-weight:bold">+</span> <span style="color:#8b949e;font-style:italic"># Color by &#39;motive&#39; variable</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">tm_layout</span>(main.title <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;World Map by Motive&#34;</span>,
</span></span><span style="display:flex;"><span>            legend.outside <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">TRUE</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">## this takes a minute to load </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">tm_shape</span>(world_sf_valid) <span style="color:#ff7b72;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">tm_borders</span>() <span style="color:#ff7b72;font-weight:bold">+</span>  <span style="color:#8b949e;font-style:italic"># Draw borders</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">tm_fill</span>(col <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;event_type&#34;</span>, palette <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;Set3&#34;</span>, title <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;Motive&#34;</span>) <span style="color:#ff7b72;font-weight:bold">+</span> <span style="color:#8b949e;font-style:italic"># Color by &#39;Event Type&#39; variable</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">tm_layout</span>(main.title <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;World Map by Event Type&#34;</span>,
</span></span><span style="display:flex;"><span>            legend.outside <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">TRUE</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># a contingency table for actor_type and event_type</span>
</span></span><span style="display:flex;"><span>actor_event_table <span style="color:#ff7b72;font-weight:bold">&lt;-</span> <span style="color:#d2a8ff;font-weight:bold">table</span>(df<span style="color:#ff7b72;font-weight:bold">$</span>actor_type, df<span style="color:#ff7b72;font-weight:bold">$</span>event_type)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># View the table</span>
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">print</span>(actor_event_table)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Plot a stacked bar chart</span>
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">ggplot</span>(df, <span style="color:#d2a8ff;font-weight:bold">aes</span>(x <span style="color:#ff7b72;font-weight:bold">=</span> actor_type, fill <span style="color:#ff7b72;font-weight:bold">=</span> event_type)) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">geom_bar</span>(position <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;fill&#34;</span>) <span style="color:#ff7b72;font-weight:bold">+</span> <span style="color:#8b949e;font-style:italic"># Use &#39;fill&#39; for proportions</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">labs</span>(x <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;Actor Type&#34;</span>, y <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;Proportion of Events&#34;</span>) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">theme_minimal</span>() <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">theme</span>(axis.text.x <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">element_text</span>(angle <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">45</span>, hjust <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">1</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Calculate attack counts per year</span>
</span></span><span style="display:flex;"><span>yearly_counts <span style="color:#ff7b72;font-weight:bold">&lt;-</span> world_sf_valid <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">group_by</span>(year) <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">summarise</span>(
</span></span><span style="display:flex;"><span>    attack_count <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">n</span>()
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Create the histogram with exact counts</span>
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">ggplot</span>(yearly_counts, <span style="color:#d2a8ff;font-weight:bold">aes</span>(x <span style="color:#ff7b72;font-weight:bold">=</span> year, y <span style="color:#ff7b72;font-weight:bold">=</span> attack_count)) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">geom_bar</span>(stat <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;identity&#34;</span>, fill <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;steelblue&#34;</span>, alpha <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0.7</span>) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">geom_text</span>(<span style="color:#d2a8ff;font-weight:bold">aes</span>(label <span style="color:#ff7b72;font-weight:bold">=</span> attack_count), 
</span></span><span style="display:flex;"><span>            vjust <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">-0.5</span>, 
</span></span><span style="display:flex;"><span>            size <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">3</span>) <span style="color:#ff7b72;font-weight:bold">+</span>  <span style="color:#8b949e;font-style:italic"># Add count labels above each bar</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">theme_minimal</span>() <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">labs</span>(
</span></span><span style="display:flex;"><span>    title <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;Number of Attacks per Year&#34;</span>,
</span></span><span style="display:flex;"><span>    x <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;Year&#34;</span>,
</span></span><span style="display:flex;"><span>    y <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;Number of Attacks&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">theme</span>(
</span></span><span style="display:flex;"><span>    plot.title <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">element_text</span>(hjust <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0.5</span>, size <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">14</span>),
</span></span><span style="display:flex;"><span>    axis.text.x <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">element_text</span>(angle <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">45</span>, hjust <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">1</span>),  <span style="color:#8b949e;font-style:italic"># Rotate x-axis labels</span>
</span></span><span style="display:flex;"><span>    panel.grid.minor <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">element_blank</span>()
</span></span><span style="display:flex;"><span>  ) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">scale_y_continuous</span>(
</span></span><span style="display:flex;"><span>    expand <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">expansion</span>(mult <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">c</span>(<span style="color:#a5d6ff">0</span>, <span style="color:#a5d6ff">0.1</span>))  <span style="color:#8b949e;font-style:italic"># Add some space at the top for labels</span>
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">ggsave</span>(<span style="color:#a5d6ff">&#34;yearly_attacks_histogram.png&#34;</span>, width <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">10</span>, height <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">6</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">summary</span>(yearly_counts)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Create a temporary directory for individual frames</span>
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">dir.create</span>(<span style="color:#a5d6ff">&#34;tmp_frames&#34;</span>, showWarnings <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">FALSE</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>create_histogram <span style="color:#ff7b72;font-weight:bold">&lt;-</span> <span style="color:#ff7b72">function</span>(data, year, yearly_counts) {
</span></span><span style="display:flex;"><span>  year_distribution <span style="color:#ff7b72;font-weight:bold">&lt;-</span> data <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>    <span style="color:#d2a8ff;font-weight:bold">filter</span>(year <span style="color:#ff7b72;font-weight:bold">==</span> <span style="color:#ff7b72;font-weight:bold">!!</span>year) <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>    <span style="color:#d2a8ff;font-weight:bold">group_by</span>(actor_type) <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>    <span style="color:#d2a8ff;font-weight:bold">summarise</span>(count <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">n</span>()) <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>    <span style="color:#d2a8ff;font-weight:bold">ungroup</span>() <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>    <span style="color:#d2a8ff;font-weight:bold">mutate</span>(percentage <span style="color:#ff7b72;font-weight:bold">=</span> count <span style="color:#ff7b72;font-weight:bold">/</span> <span style="color:#d2a8ff;font-weight:bold">sum</span>(count) <span style="color:#ff7b72;font-weight:bold">*</span> <span style="color:#a5d6ff">100</span>)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">ggplot</span>(year_distribution, <span style="color:#d2a8ff;font-weight:bold">aes</span>(x <span style="color:#ff7b72;font-weight:bold">=</span> actor_type, y <span style="color:#ff7b72;font-weight:bold">=</span> count, fill <span style="color:#ff7b72;font-weight:bold">=</span> actor_type)) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#d2a8ff;font-weight:bold">geom_bar</span>(stat <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;identity&#34;</span>, width <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0.7</span>) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#d2a8ff;font-weight:bold">scale_fill_brewer</span>(palette <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;Set3&#34;</span>) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#d2a8ff;font-weight:bold">theme_minimal</span>() <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#d2a8ff;font-weight:bold">labs</span>(
</span></span><span style="display:flex;"><span>      title <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">sprintf</span>(<span style="color:#a5d6ff">&#34;Attack Distribution (%s)&#34;</span>, <span style="color:#d2a8ff;font-weight:bold">as.character</span>(year)),
</span></span><span style="display:flex;"><span>      x <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;Actor Type&#34;</span>,
</span></span><span style="display:flex;"><span>      y <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;Number of Attacks&#34;</span>,
</span></span><span style="display:flex;"><span>      fill <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;Actor Type&#34;</span>
</span></span><span style="display:flex;"><span>    ) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#d2a8ff;font-weight:bold">theme</span>(
</span></span><span style="display:flex;"><span>      legend.position <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;right&#34;</span>,
</span></span><span style="display:flex;"><span>      plot.title <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">element_text</span>(hjust <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0.5</span>, size <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">12</span>),
</span></span><span style="display:flex;"><span>      axis.text.x <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">element_text</span>(angle <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">45</span>, hjust <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">1</span>),
</span></span><span style="display:flex;"><span>      panel.grid.major.x <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">element_blank</span>()
</span></span><span style="display:flex;"><span>    ) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#d2a8ff;font-weight:bold">geom_text</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#d2a8ff;font-weight:bold">aes</span>(label <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">paste0</span>(count, <span style="color:#a5d6ff">&#34;\n(&#34;</span>, <span style="color:#d2a8ff;font-weight:bold">round</span>(percentage, <span style="color:#a5d6ff">1</span>), <span style="color:#a5d6ff">&#34;%)&#34;</span>)),
</span></span><span style="display:flex;"><span>      position <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">position_stack</span>(vjust <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">-0.1</span>),
</span></span><span style="display:flex;"><span>      size <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">3</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Ensure year is numeric in the data and sort</span>
</span></span><span style="display:flex;"><span>world_sf_valid <span style="color:#ff7b72;font-weight:bold">&lt;-</span> world_sf_valid <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">mutate</span>(year <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">as.numeric</span>(<span style="color:#d2a8ff;font-weight:bold">as.character</span>(year))) <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">arrange</span>(year)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Process data for dominant actors</span>
</span></span><span style="display:flex;"><span>world_sf_valid <span style="color:#ff7b72;font-weight:bold">&lt;-</span> world_sf_valid <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">group_by</span>(year, geometry) <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">mutate</span>(
</span></span><span style="display:flex;"><span>    actor_count <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">n</span>(),
</span></span><span style="display:flex;"><span>    dominant_actor <span style="color:#ff7b72;font-weight:bold">=</span> actor_type<span style="color:#d2a8ff;font-weight:bold">[which.max</span>(<span style="color:#d2a8ff;font-weight:bold">table</span>(actor_type))]
</span></span><span style="display:flex;"><span>  ) <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">ungroup</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Get sorted unique years</span>
</span></span><span style="display:flex;"><span>years <span style="color:#ff7b72;font-weight:bold">&lt;-</span> <span style="color:#d2a8ff;font-weight:bold">sort</span>(<span style="color:#d2a8ff;font-weight:bold">unique</span>(world_sf_valid<span style="color:#ff7b72;font-weight:bold">$</span>year))
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">print</span>(<span style="color:#d2a8ff;font-weight:bold">paste</span>(<span style="color:#a5d6ff">&#34;Processing years in order:&#34;</span>, <span style="color:#d2a8ff;font-weight:bold">paste</span>(years, collapse <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;, &#34;</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>combined_frames <span style="color:#ff7b72;font-weight:bold">&lt;-</span> <span style="color:#d2a8ff;font-weight:bold">list</span>()
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">for</span>(i <span style="color:#ff7b72">in</span> <span style="color:#d2a8ff;font-weight:bold">seq_along</span>(years)) {
</span></span><span style="display:flex;"><span>  current_year <span style="color:#ff7b72;font-weight:bold">&lt;-</span> years[i]
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">print</span>(<span style="color:#d2a8ff;font-weight:bold">paste</span>(<span style="color:#a5d6ff">&#34;Processing year:&#34;</span>, current_year))
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#8b949e;font-style:italic"># Create histogram for current year</span>
</span></span><span style="display:flex;"><span>  histogram <span style="color:#ff7b72;font-weight:bold">&lt;-</span> <span style="color:#d2a8ff;font-weight:bold">create_histogram</span>(world_sf_valid, current_year, yearly_counts)
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">ggsave</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#d2a8ff;font-weight:bold">sprintf</span>(<span style="color:#a5d6ff">&#34;tmp_frames/histogram_%04d.png&#34;</span>, i),
</span></span><span style="display:flex;"><span>    histogram,
</span></span><span style="display:flex;"><span>    width <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">8</span>,  <span style="color:#8b949e;font-style:italic"># Increased width to accommodate bars</span>
</span></span><span style="display:flex;"><span>    height <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">6</span>,
</span></span><span style="display:flex;"><span>    bg <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;white&#34;</span>
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#8b949e;font-style:italic"># Create map for current year</span>
</span></span><span style="display:flex;"><span>  current_map <span style="color:#ff7b72;font-weight:bold">&lt;-</span> <span style="color:#d2a8ff;font-weight:bold">tm_shape</span>(world_sf_valid <span style="color:#ff7b72;font-weight:bold">%&gt;%</span> <span style="color:#d2a8ff;font-weight:bold">filter</span>(year <span style="color:#ff7b72;font-weight:bold">==</span> current_year)) <span style="color:#ff7b72;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#d2a8ff;font-weight:bold">tm_borders</span>() <span style="color:#ff7b72;font-weight:bold">+</span>  
</span></span><span style="display:flex;"><span>    <span style="color:#d2a8ff;font-weight:bold">tm_fill</span>(
</span></span><span style="display:flex;"><span>      col <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;dominant_actor&#34;</span>, 
</span></span><span style="display:flex;"><span>      palette <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;Set3&#34;</span>, 
</span></span><span style="display:flex;"><span>      title <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;Dominant Actor Type&#34;</span>
</span></span><span style="display:flex;"><span>    ) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#d2a8ff;font-weight:bold">tm_layout</span>(
</span></span><span style="display:flex;"><span>      legend.outside <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">TRUE</span>,
</span></span><span style="display:flex;"><span>      legend.position <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">c</span>(<span style="color:#a5d6ff">&#34;right&#34;</span>, <span style="color:#a5d6ff">&#34;bottom&#34;</span>),
</span></span><span style="display:flex;"><span>      title <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">sprintf</span>(<span style="color:#a5d6ff">&#34;Dominant Actors by Region (%s)&#34;</span>, <span style="color:#d2a8ff;font-weight:bold">as.character</span>(current_year)),
</span></span><span style="display:flex;"><span>      title.position <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">c</span>(<span style="color:#a5d6ff">&#34;center&#34;</span>, <span style="color:#a5d6ff">&#34;top&#34;</span>)
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">tmap_save</span>(
</span></span><span style="display:flex;"><span>    current_map, 
</span></span><span style="display:flex;"><span>    filename <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">sprintf</span>(<span style="color:#a5d6ff">&#34;tmp_frames/map_%04d.png&#34;</span>, i),
</span></span><span style="display:flex;"><span>    width <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">8</span>,
</span></span><span style="display:flex;"><span>    height <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">6</span>
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  map_img <span style="color:#ff7b72;font-weight:bold">&lt;-</span> <span style="color:#d2a8ff;font-weight:bold">image_read</span>(<span style="color:#d2a8ff;font-weight:bold">sprintf</span>(<span style="color:#a5d6ff">&#34;tmp_frames/map_%04d.png&#34;</span>, i))
</span></span><span style="display:flex;"><span>  hist_img <span style="color:#ff7b72;font-weight:bold">&lt;-</span> <span style="color:#d2a8ff;font-weight:bold">image_read</span>(<span style="color:#d2a8ff;font-weight:bold">sprintf</span>(<span style="color:#a5d6ff">&#34;tmp_frames/histogram_%04d.png&#34;</span>, i))
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  map_img <span style="color:#ff7b72;font-weight:bold">&lt;-</span> <span style="color:#d2a8ff;font-weight:bold">image_scale</span>(map_img, <span style="color:#a5d6ff">&#34;800x700!&#34;</span>)
</span></span><span style="display:flex;"><span>  hist_img <span style="color:#ff7b72;font-weight:bold">&lt;-</span> <span style="color:#d2a8ff;font-weight:bold">image_scale</span>(hist_img, <span style="color:#a5d6ff">&#34;700x500!&#34;</span>)  <span style="color:#8b949e;font-style:italic"># Adjusted size for histogram</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  combined <span style="color:#ff7b72;font-weight:bold">&lt;-</span> <span style="color:#d2a8ff;font-weight:bold">image_append</span>(<span style="color:#d2a8ff;font-weight:bold">c</span>(map_img, hist_img))
</span></span><span style="display:flex;"><span>  combined_frames[[i]] <span style="color:#ff7b72;font-weight:bold">&lt;-</span> combined
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>combined_animation <span style="color:#ff7b72;font-weight:bold">&lt;-</span> <span style="color:#d2a8ff;font-weight:bold">image_join</span>(combined_frames)
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">image_write_gif</span>(combined_animation, 
</span></span><span style="display:flex;"><span>                <span style="color:#a5d6ff">&#34;attacks_distribution_by_year.gif&#34;</span>, 
</span></span><span style="display:flex;"><span>                delay <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">4</span>)
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">unlink</span>(<span style="color:#a5d6ff">&#34;tmp_frames&#34;</span>, recursive <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">TRUE</span>)
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">print</span>(<span style="color:#a5d6ff">&#34;GIF creation completed&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">## made with help from Claude and </span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">## https://r.geocompx.org/adv-map#prerequisites-7</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">## https://r-tmap.github.io/tmap-book/tmshape.html</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">library</span>(viridis)  <span style="color:#8b949e;font-style:italic"># For better color scales</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Create a temporary directory for individual frames</span>
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">dir.create</span>(<span style="color:#a5d6ff">&#34;tmp_frames&#34;</span>, showWarnings <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">FALSE</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Ensure year is numeric in the data and sort</span>
</span></span><span style="display:flex;"><span>world_sf_valid <span style="color:#ff7b72;font-weight:bold">&lt;-</span> world_sf_valid <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">mutate</span>(year <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">as.numeric</span>(<span style="color:#d2a8ff;font-weight:bold">as.character</span>(year))) <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">arrange</span>(year)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Process data to count events per region</span>
</span></span><span style="display:flex;"><span>world_sf_valid <span style="color:#ff7b72;font-weight:bold">&lt;-</span> world_sf_valid <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">group_by</span>(year, geometry) <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">summarise</span>(
</span></span><span style="display:flex;"><span>    event_count <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">n</span>(),
</span></span><span style="display:flex;"><span>    .groups <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#39;drop&#39;</span>
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Get sorted unique years</span>
</span></span><span style="display:flex;"><span>years <span style="color:#ff7b72;font-weight:bold">&lt;-</span> <span style="color:#d2a8ff;font-weight:bold">sort</span>(<span style="color:#d2a8ff;font-weight:bold">unique</span>(world_sf_valid<span style="color:#ff7b72;font-weight:bold">$</span>year))
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">print</span>(<span style="color:#d2a8ff;font-weight:bold">paste</span>(<span style="color:#a5d6ff">&#34;Processing years in order:&#34;</span>, <span style="color:#d2a8ff;font-weight:bold">paste</span>(years, collapse <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;, &#34;</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>map_frames <span style="color:#ff7b72;font-weight:bold">&lt;-</span> <span style="color:#d2a8ff;font-weight:bold">list</span>()
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">for</span>(i <span style="color:#ff7b72">in</span> <span style="color:#d2a8ff;font-weight:bold">seq_along</span>(years)) {
</span></span><span style="display:flex;"><span>  current_year <span style="color:#ff7b72;font-weight:bold">&lt;-</span> years[i]
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">print</span>(<span style="color:#d2a8ff;font-weight:bold">paste</span>(<span style="color:#a5d6ff">&#34;Processing year:&#34;</span>, current_year))
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#8b949e;font-style:italic"># Create map for current year</span>
</span></span><span style="display:flex;"><span>  current_map <span style="color:#ff7b72;font-weight:bold">&lt;-</span> <span style="color:#d2a8ff;font-weight:bold">tm_shape</span>(world_sf_valid <span style="color:#ff7b72;font-weight:bold">%&gt;%</span> <span style="color:#d2a8ff;font-weight:bold">filter</span>(year <span style="color:#ff7b72;font-weight:bold">==</span> current_year)) <span style="color:#ff7b72;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#d2a8ff;font-weight:bold">tm_borders</span>(col <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;darkgray&#34;</span>, lwd <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0.5</span>) <span style="color:#ff7b72;font-weight:bold">+</span>  
</span></span><span style="display:flex;"><span>    <span style="color:#d2a8ff;font-weight:bold">tm_fill</span>(
</span></span><span style="display:flex;"><span>      col <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;event_count&#34;</span>,
</span></span><span style="display:flex;"><span>      title <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;Number of Events&#34;</span>,
</span></span><span style="display:flex;"><span>      style <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;jenks&#34;</span>,  <span style="color:#8b949e;font-style:italic"># Natural breaks classification</span>
</span></span><span style="display:flex;"><span>      palette <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;viridis&#34;</span>,  <span style="color:#8b949e;font-style:italic"># Using viridis palette for better color perception</span>
</span></span><span style="display:flex;"><span>      n <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">7</span>,  <span style="color:#8b949e;font-style:italic"># Number of classes</span>
</span></span><span style="display:flex;"><span>      contrast <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">c</span>(<span style="color:#a5d6ff">0.2</span>, <span style="color:#a5d6ff">1</span>),  <span style="color:#8b949e;font-style:italic"># Adjust contrast of colors</span>
</span></span><span style="display:flex;"><span>      legend.hist <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">TRUE</span>  <span style="color:#8b949e;font-style:italic"># Add histogram to legend</span>
</span></span><span style="display:flex;"><span>    ) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#d2a8ff;font-weight:bold">tm_layout</span>(
</span></span><span style="display:flex;"><span>      main.title <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">sprintf</span>(<span style="color:#a5d6ff">&#34;Event Frequency by Region (%s)&#34;</span>, <span style="color:#d2a8ff;font-weight:bold">as.character</span>(current_year)),
</span></span><span style="display:flex;"><span>      main.title.position <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">c</span>(<span style="color:#a5d6ff">&#34;center&#34;</span>, <span style="color:#a5d6ff">&#34;top&#34;</span>),
</span></span><span style="display:flex;"><span>      main.title.size <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">1.2</span>,
</span></span><span style="display:flex;"><span>      legend.outside <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">TRUE</span>,
</span></span><span style="display:flex;"><span>      legend.position <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">c</span>(<span style="color:#a5d6ff">&#34;right&#34;</span>, <span style="color:#a5d6ff">&#34;center&#34;</span>),
</span></span><span style="display:flex;"><span>      legend.title.size <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0.8</span>,
</span></span><span style="display:flex;"><span>      frame <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">FALSE</span>,
</span></span><span style="display:flex;"><span>      bg.color <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;white&#34;</span>
</span></span><span style="display:flex;"><span>    ) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#d2a8ff;font-weight:bold">tm_scale_bar</span>(position <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">c</span>(<span style="color:#a5d6ff">&#34;left&#34;</span>, <span style="color:#a5d6ff">&#34;bottom&#34;</span>)) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#d2a8ff;font-weight:bold">tm_grid</span>(alpha <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0.2</span>)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">tmap_save</span>(
</span></span><span style="display:flex;"><span>    current_map, 
</span></span><span style="display:flex;"><span>    filename <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">sprintf</span>(<span style="color:#a5d6ff">&#34;tmp_frames/map_%04d.png&#34;</span>, i),
</span></span><span style="display:flex;"><span>    width <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">12</span>,
</span></span><span style="display:flex;"><span>    height <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">8</span>,
</span></span><span style="display:flex;"><span>    bg <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;white&#34;</span>,
</span></span><span style="display:flex;"><span>    dpi <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">300</span>
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  map_img <span style="color:#ff7b72;font-weight:bold">&lt;-</span> <span style="color:#d2a8ff;font-weight:bold">image_read</span>(<span style="color:#d2a8ff;font-weight:bold">sprintf</span>(<span style="color:#a5d6ff">&#34;tmp_frames/map_%04d.png&#34;</span>, i))
</span></span><span style="display:flex;"><span>  map_frames[[i]] <span style="color:#ff7b72;font-weight:bold">&lt;-</span> map_img
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Combine all frames into a GIF</span>
</span></span><span style="display:flex;"><span>map_animation <span style="color:#ff7b72;font-weight:bold">&lt;-</span> <span style="color:#d2a8ff;font-weight:bold">image_join</span>(map_frames)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Write the final GIF with slightly longer delay for better readability</span>
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">image_write_gif</span>(map_animation, 
</span></span><span style="display:flex;"><span>                <span style="color:#a5d6ff">&#34;event_frequency_choropleth.gif&#34;</span>, 
</span></span><span style="display:flex;"><span>                delay <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Clean up temporary files</span>
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">unlink</span>(<span style="color:#a5d6ff">&#34;tmp_frames&#34;</span>, recursive <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">TRUE</span>)
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">print</span>(<span style="color:#a5d6ff">&#34;GIF creation completed&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>growth_rate <span style="color:#ff7b72;font-weight:bold">&lt;-</span> yearly_counts <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#8b949e;font-style:italic"># Ensure &#39;year&#39; is numeric</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">mutate</span>(year <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">as.numeric</span>(<span style="color:#d2a8ff;font-weight:bold">as.character</span>(year))) <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#8b949e;font-style:italic"># Sort by year</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">arrange</span>(year) <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#8b949e;font-style:italic"># Compute differences and growth rate</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">mutate</span>(
</span></span><span style="display:flex;"><span>    Diff_year <span style="color:#ff7b72;font-weight:bold">=</span> year <span style="color:#ff7b72;font-weight:bold">-</span> <span style="color:#d2a8ff;font-weight:bold">lag</span>(year),  <span style="color:#8b949e;font-style:italic"># Calculate year difference</span>
</span></span><span style="display:flex;"><span>    Diff_growth <span style="color:#ff7b72;font-weight:bold">=</span> yearly_counts<span style="color:#ff7b72;font-weight:bold">$</span>attack_count <span style="color:#ff7b72;font-weight:bold">-</span> <span style="color:#d2a8ff;font-weight:bold">lag</span>(yearly_counts<span style="color:#ff7b72;font-weight:bold">$</span>attack_count),  <span style="color:#8b949e;font-style:italic"># Calculate route difference</span>
</span></span><span style="display:flex;"><span>    Rate_percent <span style="color:#ff7b72;font-weight:bold">=</span> (Diff_growth <span style="color:#ff7b72;font-weight:bold">/</span> Diff_year) <span style="color:#ff7b72;font-weight:bold">/</span> <span style="color:#d2a8ff;font-weight:bold">lag</span>(yearly_counts<span style="color:#ff7b72;font-weight:bold">$</span>attack_count) <span style="color:#ff7b72;font-weight:bold">*</span> <span style="color:#a5d6ff">100</span>  <span style="color:#8b949e;font-style:italic"># Compute growth rate percentage</span>
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">## made with help from https://forum.posit.co/t/growth-rate-calculation-in-r/38675/2</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">## Matthias</span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">## bennyishere</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>growth_rate
</span></span></code></pre></div><h2 id="number-of-attacks-per-year">
  Number of Attacks per Year
  <a class="heading-link" href="#number-of-attacks-per-year">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>The histogram has shown an upward trend in attack counts per year. There will be a significant increase in the number of attacks in 2019-2020 and again in 2021-2022. On both occasions, we saw about a 50% increase in the number of attacks. With a median of 952, it seems as though the number of attacks per year that will be observed in the coming years will increase as well.
Attack Distribution by Year</p>
<h2 id="2014">
  2014
  <a class="heading-link" href="#2014">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Criminal actors (light blue) are widespread, especially in North America, parts of Latin America, and scattered regions in Asia. This indicates that cybercrime was a prominent issue globally, likely involving financial motives.
Hacktivists (red) are primarily concentrated in isolated areas, particularly in Europe, showing that politically or socially motivated cyber activities had specific regional impacts.
Nation-state actors (dark green) are notably present in East Asia, parts of the Middle East, and North America. This suggests that certain governments were already engaged in cyber operations, possibly for espionage or strategic gains.
Undetermined actors (light green) are also present in various regions, indicating that some areas faced cyber activities without clear attribution.</p>
<h2 id="2015-2016">
  2015-2016
  <a class="heading-link" href="#2015-2016">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>The influence of nation-state actors expands, especially across East Asia and parts of the Middle East, pointing to an increase in government-backed cyber operations. This could be related to global geopolitical tensions and a rise in cyber espionage activities.
Criminal actors continue to appear frequently across multiple continents, reflecting the steady persistence of financially motivated cybercrime globally.
Hacktivist activity remains limited to specific areas but shows sporadic presence, suggesting that hacktivist campaigns may have been reactive to regional social and political events.</p>
<h2 id="2017-2018">
  2017-2018
  <a class="heading-link" href="#2017-2018">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Nation-state actors maintain a strong presence in Asia and expand to new areas in Europe and North America, which could correlate with heightened global cyber espionage and intelligence-gathering.
The dominance of criminal actors remains consistent in many countries, particularly in North America, Latin America, and parts of Europe, indicating an ongoing global problem with cybercrime.
Hacktivist activity is sparse but visible in certain hotspots, implying that hacktivism remains active but localized, likely responding to specific issues.</p>
<h2 id="2019-2020">
  2019-2020
  <a class="heading-link" href="#2019-2020">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Nation-state actor dominance appears to further expand in Asia and parts of Europe, signaling the sustained importance of cyber capabilities in national security strategies.
The criminal actor category continues to show prevalence across regions, highlighting the entrenchment of cybercrime in the global threat landscape.
Undetermined actors show up in a few regions, which could imply either a lack of attribution or diverse motivations that make categorization difficult.</p>
<h2 id="2021-2022">
  2021-2022
  <a class="heading-link" href="#2021-2022">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Nation-state dominance becomes more pronounced, especially in strategic regions in Asia, Europe, and North America. This period likely reflects intensifying cyber operations by countries to protect national interests or gain intelligence.
Criminal actors maintain a steady global footprint, emphasizing the resilience and adaptability of cybercriminals.
Hacktivist activity remains minimal, suggesting that hacktivist movements have become less prominent, possibly due to stronger law enforcement or shifts in social movements.</p>
<h2 id="2023">
  2023
  <a class="heading-link" href="#2023">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Nation-state actors continue to dominate many regions, showing how state-sponsored cyber activities have become a central component of international relations and security strategies.
Criminal actor prevalence persists, particularly in economically significant or technologically advanced regions, indicating that cybercrime remains a persistent threat worldwide.
Undetermined actor presence is observed in certain areas, implying ongoing difficulty in clearly attributing cyber activities in some regions.</p>
<h2 id="whats-happening">
  What&rsquo;s happening?
  <a class="heading-link" href="#whats-happening">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Nation-state actors have consistently grown in influence from 2014 to 2023, particularly in Asia, Europe, and North America. This reflects the increasing use of cyber capabilities by governments for both defense and intelligence.</p>
<p>Criminal actors are widespread across all frames, highlighting that cybercrime is a constant, pervasive issue with global impact.</p>
<p>Hacktivists appear sporadically, usually concentrated in specific regions, suggesting that their activity is more event-driven and localized.</p>
<p>Undetermined actors persist in some regions, showing the complexity of attributing cyber activities accurately. This indicates a shift towards a more polarized cyber environment where geopolitical and economic factors drive cyber operations.</p>
<h2 id="event-frequency-by-region">
  Event Frequency by Region
  <a class="heading-link" href="#event-frequency-by-region">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>North America: The U.S. stands out with significant activity, while Canada and Mexico show moderate levels.</p>
<p>Europe: A mix of low-to-moderate activity, with no regions appearing in the highest range.</p>
<p>Asia: Some regions in South Asia and East Asia show moderate to high activity. Which may be attributed to concentrated events in countries like India or China.</p>
<p>Africa and Oceania: Predominantly low activity, with few regions showing notable event frequencies.</p>
<h2 id="growth-rates">
  Growth Rates
  <a class="heading-link" href="#growth-rates">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<h3 id="overall-growth">
  Overall Growth:
  <a class="heading-link" href="#overall-growth">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>From 2014 to 2023, the number of cyberattacks increased significantly. The attack count started at 570 in 2014 and rose to 2,163 in 2023, which reflects a substantial overall increase in cyberattacks over the period.</p>
<h2 id="annual-growth-variability">
  Annual Growth Variability:
  <a class="heading-link" href="#annual-growth-variability">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>The growth rate year-on-year is highly variable. For example: The growth from 2014 to 2015 was moderate, at around 23%. The growth from 2015 to 2016 saw a steep rise of 35.8%.</p>
<p>From 2016 to 2017, there was a significant decrease in the number of attacks, with a drop of -27.7%. From 2019 to 2020, there was a sharp spike of 59.3%, possibly reflecting changes in attack patterns, maybe due to the COVID-19 pandemic and the shift to online activities. The largest growth occurred between 2021 and 2022, with a 68.1% increase in attacks, suggesting a notable escalation in cyber activity. Looking at the median the mean can see around a 13% or 9% positive change annually.  However given the amount of fluctuations in the short observable years, not much can be predicted accurately. Although, we shall do it anyway!</p>
<h2 id="peak-attack-years">
  Peak Attack Years:
  <a class="heading-link" href="#peak-attack-years">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>The peak year for cyberattacks was 2023 with 2,163 attacks, following the rise seen in 2022. The total attack count in these years is higher than the earlier years, however, the database needs to be updated to fully reflect the attacks for that year.</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Calculate percent change for each region</span>
</span></span><span style="display:flex;"><span>world_sf_changes <span style="color:#ff7b72;font-weight:bold">&lt;-</span> world_sf_valid <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">group_by</span>(geometry) <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">summarise</span>(
</span></span><span style="display:flex;"><span>    start_count <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">sum</span>(<span style="color:#d2a8ff;font-weight:bold">ifelse</span>(year <span style="color:#ff7b72;font-weight:bold">==</span> <span style="color:#a5d6ff">2014</span>, event_count, <span style="color:#a5d6ff">0</span>)),
</span></span><span style="display:flex;"><span>    end_count <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">sum</span>(<span style="color:#d2a8ff;font-weight:bold">ifelse</span>(year <span style="color:#ff7b72;font-weight:bold">==</span> <span style="color:#a5d6ff">2022</span>, event_count, <span style="color:#a5d6ff">0</span>)),
</span></span><span style="display:flex;"><span>    .groups <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#39;drop&#39;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#ff7b72;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">mutate</span>(
</span></span><span style="display:flex;"><span>    percent_change <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">ifelse</span>(start_count <span style="color:#ff7b72;font-weight:bold">&gt;</span> <span style="color:#a5d6ff">0</span>,
</span></span><span style="display:flex;"><span>                           ((end_count <span style="color:#ff7b72;font-weight:bold">-</span> start_count) <span style="color:#ff7b72;font-weight:bold">/</span> start_count) <span style="color:#ff7b72;font-weight:bold">*</span> <span style="color:#a5d6ff">100</span>,
</span></span><span style="display:flex;"><span>                           <span style="color:#d2a8ff;font-weight:bold">ifelse</span>(end_count <span style="color:#ff7b72;font-weight:bold">&gt;</span> <span style="color:#a5d6ff">0</span>, <span style="color:#a5d6ff">100</span>, <span style="color:#a5d6ff">0</span>)),
</span></span><span style="display:flex;"><span>    <span style="color:#8b949e;font-style:italic"># Cap extreme values for better visualization</span>
</span></span><span style="display:flex;"><span>    percent_change_capped <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">pmin</span>(<span style="color:#d2a8ff;font-weight:bold">pmax</span>(percent_change, <span style="color:#a5d6ff">-100</span>), <span style="color:#a5d6ff">100</span>)
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Create a diverging color palette map</span>
</span></span><span style="display:flex;"><span>map_changes <span style="color:#ff7b72;font-weight:bold">&lt;-</span> <span style="color:#d2a8ff;font-weight:bold">tm_shape</span>(world_sf_changes) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">tm_borders</span>(col <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;darkgray&#34;</span>, lwd <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0.5</span>) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">tm_fill</span>(
</span></span><span style="display:flex;"><span>    col <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;percent_change_capped&#34;</span>,
</span></span><span style="display:flex;"><span>    title <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;% Change (2014-2022)&#34;</span>,
</span></span><span style="display:flex;"><span>    style <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;pretty&#34;</span>,
</span></span><span style="display:flex;"><span>    palette <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;RdYlBu&#34;</span>,  <span style="color:#8b949e;font-style:italic"># Red-Yellow-Blue diverging palette</span>
</span></span><span style="display:flex;"><span>    midpoint <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0</span>,        <span style="color:#8b949e;font-style:italic"># Center the color scale at 0</span>
</span></span><span style="display:flex;"><span>    contrast <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">c</span>(<span style="color:#a5d6ff">0.2</span>, <span style="color:#a5d6ff">1</span>),
</span></span><span style="display:flex;"><span>    n <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">9</span>,              <span style="color:#8b949e;font-style:italic"># Number of color classes</span>
</span></span><span style="display:flex;"><span>    legend.hist <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">TRUE</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">tm_layout</span>(
</span></span><span style="display:flex;"><span>    main.title <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;Event Frequency Change by Region (2014-2022)&#34;</span>,
</span></span><span style="display:flex;"><span>    main.title.position <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">c</span>(<span style="color:#a5d6ff">&#34;center&#34;</span>, <span style="color:#a5d6ff">&#34;top&#34;</span>),
</span></span><span style="display:flex;"><span>    main.title.size <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">1.2</span>,
</span></span><span style="display:flex;"><span>    legend.outside <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">TRUE</span>,
</span></span><span style="display:flex;"><span>    legend.position <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">c</span>(<span style="color:#a5d6ff">&#34;right&#34;</span>, <span style="color:#a5d6ff">&#34;center&#34;</span>),
</span></span><span style="display:flex;"><span>    legend.title.size <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0.8</span>,
</span></span><span style="display:flex;"><span>    frame <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">FALSE</span>,
</span></span><span style="display:flex;"><span>    bg.color <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;white&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">tm_scale_bar</span>(position <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">c</span>(<span style="color:#a5d6ff">&#34;left&#34;</span>, <span style="color:#a5d6ff">&#34;bottom&#34;</span>)) <span style="color:#ff7b72;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">tm_grid</span>(alpha <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0.2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># Save the map</span>
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">tmap_save</span>(
</span></span><span style="display:flex;"><span>  map_changes,
</span></span><span style="display:flex;"><span>  filename <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;event_frequency_changes.png&#34;</span>,
</span></span><span style="display:flex;"><span>  width <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">12</span>,
</span></span><span style="display:flex;"><span>  height <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">8</span>,
</span></span><span style="display:flex;"><span>  bg <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;white&#34;</span>,
</span></span><span style="display:flex;"><span>  dpi <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">300</span>
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div>
  </article>
</section>

  

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
    2024
     DarkAwesome 
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/blog/js/coder.js"></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>

</html>
